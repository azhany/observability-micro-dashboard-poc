# Risk Profile: Story 2.3

Date: 2026-01-18
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 5
- Critical Risks: 0
- High Risks: 2
- Risk Score: 68/100

## High Risks Requiring Attention

### 1. SEC-001: Tenant Data Isolation via SSE

**Score: 6 (High)**
**Probability**: Medium (2) - SSE endpoints often require specific middleware handling to ensure session/auth context is maintained over long-lived connections.
**Impact**: High (3) - Potential for cross-tenant data leakage if the `tenantId` parameter in the SSE URL is not strictly validated against the authenticated user's permissions.
**Mitigation**:
- Enforce tenant-check middleware on the SSE route.
- Validate `tenantId` in the `StreamService.connect()` method against the user's active session.
**Testing Focus**: Negative testing - attempt to connect to a different tenant's stream using a valid session from another tenant.

### 2. TECH-002: SSE Connection Lifecycle and Stability

**Score: 6 (High)**
**Probability**: High (3) - SSE connections can be dropped by proxies, load balancers, or browser hibernation.
**Impact**: Medium (2) - Users lose real-time visibility; the "Live" indicator may show false positives or chart stops updating.
**Mitigation**:
- Implement robust reconnection logic in `StreamService.ts`.
- Add heartbeat monitoring to detect silent connection failures.
- Ensure `EventSource` is closed on component unmount to prevent resource leaks.
**Testing Focus**: Network failure simulation (offline/online transitions), long-running connection tests, and multiple tab behavior.

## Risk Distribution

### By Category

- Security: 1 risk (1 high)
- Performance: 1 risk (1 medium)
- Technical: 2 risks (1 high, 1 medium)
- Data: 1 risk (1 low)

### By Component

- Frontend (Component): 3 risks
- Frontend (Service): 2 risks
- Backend (SSE Endpoint): 1 risk

## Detailed Risk Register

| Risk ID | Description | Probability | Impact | Score | Priority |
| :--- | :--- | :--- | :--- | :--- | :--- |
| SEC-001 | Tenant data exposure via SSE | Medium (2) | High (3) | 6 | High |
| TECH-002 | SSE connection lifecycle/stability | High (3) | Medium (2) | 6 | High |
| PERF-001 | Chart rendering lag @ high freq | Medium (2) | Medium (2) | 4 | Medium |
| TECH-001 | Memory leak from data accumulation | Medium (2) | Medium (2) | 4 | Medium |
| DATA-001 | Out-of-order SSE events | Low (1) | Medium (2) | 2 | Low |

## Risk-Based Testing Strategy

### Priority 1: High Risk Tests (Security & Connectivity)
- **Multi-tenant isolation**: Verify that a user cannot access data from another `tenant_id` by manipulating the URL or props.
- **Reconnection Logic**: Kill the server process/disconnect network and verify the `StreamService` attempts to reconnect and the UI reflects the status.

### Priority 2: Performance & Resource Management
- **High-frequency Load**: Simulate 5-10 updates per second for several minutes. Monitor browser CPU and Memory.
- **Cleanup Verification**: Mount and unmount the component 50 times in a loop. Verify memory usage returns to baseline and `EventSource` connections are closed.

### Priority 3: Visual & Functional
- **Live Indicator**: Verify pulsing red dot appears when connected and disappears/grays out when disconnected.
- **Chart Accuracy**: Cross-reference chart values with a static data source or logs.

## Risk Acceptance Criteria

### Must Fix Before Production
- SEC-001 (Security) - No data leakage allowed.
- TECH-002 (Stability) - Basic reconnection logic must be present.

### Can Deploy with Mitigation
- PERF-001 - If performance is acceptable at 1 update/sec, higher frequencies can be optimized later.
- TECH-001 - Data point limiting (e.g., last 50 points) must be implemented.

## Monitoring Requirements
- SSE connection error rates in frontend logging.
- Average browser memory usage per dashboard session.
- SSE endpoint response times/uptime.

---
Risk profile: docs/qa/assessments/2.3.reactive-metric-chart-component-risk-20260118.md
