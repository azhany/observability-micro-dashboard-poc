# Test Design: Story 3.2

Date: 2026-01-18
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 9
- Unit tests: 6 (67%)
- Integration tests: 2 (22%)
- E2E tests: 1 (11%)
- Priority distribution: P0: 4, P1: 4, P2: 1

## Test Scenarios by Acceptance Criteria

### AC1: Go 1.2x project initialized in the monorepo

#### Scenarios

| ID | Level | Priority | Test | Justification |
| :--- | :--- | :--- | :--- | :--- |
| 3.2-UNIT-001 | Unit | P1 | Project Initialization | Verify `go.mod` exists and has correct module name. |

### AC2: Agent successfully collects CPU, Memory, and Disk usage

#### Scenarios

| ID | Level | Priority | Test | Justification |
| :--- | :--- | :--- | :--- | :--- |
| 3.2-UNIT-002 | Unit | P0 | CPU Collector Returns Value | Validate CPU collector returns non-error, non-negative value. |
| 3.2-UNIT-003 | Unit | P0 | Memory Collector Returns Value | Validate Memory collector returns non-error, valid bytes. |
| 3.2-UNIT-004 | Unit | P0 | Disk Collector Returns Value | Validate Disk collector returns non-error, valid percentage. |
| 3.2-INT-001 | Integration | P1 | Collectors Interface Compliance | Ensure all collectors satisfy the common interface for the main loop. |

### AC3: Collection interval is configurable via environment variables

#### Scenarios

| ID | Level | Priority | Test | Justification |
| :--- | :--- | :--- | :--- | :--- |
| 3.2-UNIT-005 | Unit | P0 | Config Load Defaults | Verify default interval (5s) when ENV is missing. |
| 3.2-UNIT-006 | Unit | P1 | Config Load Override | Verify ENV `COLLECTION_INTERVAL` overrides default. |
| 3.2-UNIT-007 | Unit | P2 | Config Invalid Interval | Verify fallback or error on invalid interval string. |

### AC4: The agent outputs metrics to stdout

#### Scenarios

| ID | Level | Priority | Test | Justification |
| :--- | :--- | :--- | :--- | :--- |
| 3.2-E2E-001 | E2E | P1 | Agent Stdout Output | Run binary, capture stdout, validate JSON structure & values. |

## Risk Coverage

- **DATA-001 (CPU Metric Initial 0)**: Covered by *3.2-E2E-001* (inspect first output frame) and *3.2-UNIT-002* (mocked warm-up).
- **TECH-001 (OS Inconsistency)**: Covered by *3.2-E2E-001* (when run in CI/Docker).
- **PERF-001 (Blocking)**: Partially covered by *3.2-INT-001* (can mock slow collector).
- **OPS-001 (Config Validation)**: Covered by *3.2-UNIT-007*.

## Recommended Execution Order

1. P0 Unit tests (Collectors & Config Defaults)
2. P1 Unit tests (Project Init, Config Override)
3. P1 Integration tests (Collector Interface)
4. P1 E2E tests (Binary Output)
5. P2 Unit tests (Config Edge Cases)
