# Test Design: Story 3.4.multi-agent-management-view

Date: 2026-01-18
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 11
- Unit tests: 3 (27%)
- Integration tests: 6 (55%)
- E2E tests: 2 (18%)
- Priority distribution: P0: 4, P1: 4, P2: 3

## Test Scenarios by Acceptance Criteria

### AC1 & AC2: Agent List, Status, and Last Seen Logic

#### Scenarios

| ID           | Level       | Priority | Test                                      | Justification                                     |
| ------------ | ----------- | -------- | ----------------------------------------- | ------------------------------------------------- |
| 3.4-INT-001  | Integration | P0       | DashboardController calculates 'Online'   | Validates DB aggregation logic with real timestamps |
| 3.4-INT-002  | Integration | P0       | DashboardController calculates 'Offline'  | Validates 60s timeout threshold logic             |
| 3.4-INT-003  | Integration | P0       | Tenant isolation in Agent List            | **Critical Security**: Mitigates SEC-001 risk     |
| 3.4-UNIT-001 | Unit        | P1       | Overview.vue status badge color mapping   | UI logic for badge visibility                     |

### AC3: Dashboard Filtering

#### Scenarios

| ID           | Level       | Priority | Test                                      | Justification                                     |
| ------------ | ----------- | -------- | ----------------------------------------- | ------------------------------------------------- |
| 3.4-E2E-001  | E2E         | P1       | Click agent navigates with query param    | Validates user journey from list to detail        |
| 3.4-UNIT-002 | Unit        | P2       | TenantDetail.vue extracts agentId from URL| Component logic for parameter parsing             |

### AC4 & AC5: Realtime Chart Integration and Metric Handling

#### Scenarios

| ID           | Level       | Priority | Test                                      | Justification                                     |
| ------------ | ----------- | -------- | ----------------------------------------- | ------------------------------------------------- |
| 3.4-UNIT-003 | Unit        | P1       | RealtimeChart.vue filters by agentId prop | Mitigates PERF-002: avoids rendering wrong data   |
| 3.4-INT-004  | Integration | P1       | RealtimeChart.vue handles metric_name key | **Critical Data**: Mitigates DATA-001 risk        |
| 3.4-INT-005  | Integration | P2       | RealtimeChart.vue handles array payloads  | Validates compatibility with ProcessMetricSubmission|
| 3.4-INT-006  | Integration | P2       | Multi-metric handling (CPU/MEM/DISK)      | Ensures all 3 Go metrics are processed correctly  |
| 3.4-E2E-002  | E2E         | P1       | Real-time updates only for selected agent | Final validation of the filtered data stream      |

## Risk Coverage

| Risk ID  | Mitigated By Scenario(s) | Coverage Type |
| -------- | ------------------------ | ------------- |
| SEC-001  | 3.4-INT-003              | Direct Check  |
| PERF-001 | 3.4-INT-001, 3.4-INT-002 | Indirect (via load simulation in INT) |
| PERF-002 | 3.4-UNIT-003, 3.4-E2E-002 | Logic & User Experience |
| DATA-001 | 3.4-INT-004, 3.4-INT-006 | Direct Mapping |
| OPS-001  | 3.4-INT-002              | Boundary Test |

## Recommended Execution Order

1. **3.4-INT-003 (P0 Integration)**: Verify tenant isolation first.
2. **3.4-INT-001/002 (P0 Integration)**: Verify status logic.
3. **3.4-UNIT-001/002/003 (P1/P2 Unit)**: Verify component-level logic.
4. **3.4-INT-004/005/006 (P1/P2 Integration)**: Verify data parsing and metric mapping.
5. **3.4-E2E-001/002 (P1 E2E)**: Final verification of the integrated feature.
