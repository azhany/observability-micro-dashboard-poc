# Story 2.1: Base Dashboard Layout & Tenant View

## Status
Draft

## Story
**As a** System Operator,
**I want** a modern, dark-mode dashboard interface,
**so that** I can view a high-level summary of my tenant's health.

## Acceptance Criteria
1. Vue 3 dashboard features a sidebar for navigation and a main content area for widgets.
2. An "Overview" page displays a list of active agents and their last reported status.
3. A "Tenant Detail" page exists that accepts a tenant ID and prepares placeholders for metric charts.
4. UI is styled using Tailwind CSS with a consistent "Technical/NOC" aesthetic.

## Tasks / Subtasks
- [ ] Task 1: Frontend Setup & Layout (AC: 1, 4)
    - [ ] Create `resources/js/Layouts/DashboardLayout.vue`.
    - [ ] Implement Sidebar navigation (Home, Alerts, Settings). [Source: docs/front-end-spec.md#3-information-architecture-ia]
    - [ ] Implement "NOC-First" Dark Mode styling (Bg: `#0B0E14`, Card: `#161B22`, Primary: `#00D1FF`). [Source: docs/front-end-spec.md#7-branding--style-guide]
    - [ ] Ensure `tailwind.config.js` includes these custom colors.
- [ ] Task 2: Dashboard Controller & Routes (AC: 2, 3)
    - [ ] Create `App\Http\Controllers\DashboardController`.
    - [ ] Define routes in `routes/web.php`:
        - `GET /dashboard` -> `index` (Overview).
        - `GET /dashboard/tenants/{tenant}` -> `show` (Detail).
    - [ ] Apply `auth` and `verified` middleware (if applicable, or just `auth`).
- [ ] Task 3: Overview Page Implementation (AC: 2, 4)
    - [ ] Create `resources/js/Pages/Dashboard/Overview.vue`.
    - [ ] In Controller `index` method: Fetch distinct `agent_id`s from `metrics_raw` table for the current tenant.
    - [ ] Display agents in a grid/list with "Status" placeholders (e.g., "Online").
    - [ ] Use `Link` component to navigate to Tenant Detail view.
- [ ] Task 4: Tenant Detail Page Implementation (AC: 3, 4)
    - [ ] Create `resources/js/Pages/Dashboard/TenantDetail.vue`.
    - [ ] In Controller `show` method: Pass `tenant` and `agent_id` (if filtered) props.
    - [ ] Add placeholder `div`s for Future Charts (CPU, Memory, Disk).
    - [ ] Add "Live/Historical" toggle switch (UI only). [Source: docs/front-end-spec.md#key-screen-layouts-tenant-detail-view]
- [ ] Task 5: Integration Testing (AC: 1, 2, 3)
    - [ ] Create `tests/Feature/DashboardTest.php`.
    - [ ] Test that `/dashboard` renders `Dashboard/Overview` component.
    - [ ] Test that `/dashboard/tenants/{id}` renders `Dashboard/TenantDetail` component.
    - [ ] Verify agent list data is passed to the view.

## Dev Notes
- **Project Structure:**
    - `resources/js/Layouts` directory needs to be created if it doesn't exist.
    - `resources/js/Pages/Dashboard` directory needs to be created.
- **Data Models:**
    - `Metric` model exists (`App\Models\Metric`). Use `Metric::where('tenant_id', $tenantId)->distinct()->pluck('agent_id')` to get agents.
    - **Note:** `tenant_id` in DB is Binary(16). Ensure the Controller handles the conversion or the Model casts it correctly when querying.
- **Styling:**
    - Use `lucide-vue-next` for icons if available, or heroicons (default in some Laravel kits). Preference: Lucide (per Spec).
    - Fonts: Inter and JetBrains Mono. Add to `resources/css/app.css` or `blade` layout.
- **Previous Story Insights:**
    - `metrics_raw` table is populated. We can seed some data or manually create metrics to verify the "Overview" list.

### Testing
- **Test File Location:** `tests/Feature/DashboardTest.php`
- **Test Standards:** Laravel Pest/PHPUnit (Inertia testing helpers).
- **Frameworks:** `Inertia::testing()`.
- **Specific Requirements:**
    - Verify component names.
    - Verify props (agents list, tenant details).
    - Ensure 200 OK response for auth users.

## Change Log
| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2026-01-18 | 1.0 | Initial Story Draft | Bob (Scrum Master) |

## Dev Agent Record
### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results